# GitJob KZ

IT-агрегатор вакансий для Казахстана с AI-фильтрацией, карьерным тестом и персональными рекомендациями.

**Demo:** [gitjob.kz](http://gitjob.kz) | **API Docs:** [gitjob.kz/api/docs](http://gitjob.kz/api/docs)

## Что делает

GitJob собирает IT-вакансии с HeadHunter, автоматически отсеивает нерелевантные через GPT-4o и помогает с выбором карьеры:

- **Каталог вакансий** — полнотекстовый поиск, фильтры по городу/грейду/стеку/зарплате, сортировка, пагинация
- **AI-классификация** — GPT-4o анализирует каждую вакансию и убирает не-IT роли (водители, бухгалтеры и т.д.)
- **Карьерный тест** — интерактивная оценка, которая подбирает одну из 7 IT-ролей с рекомендацией этапа развития
- **Рекомендации** — подбор вакансий на основе навыков и грейда из профиля
- **Каталог компаний** — работодатели с количеством активных вакансий
- **Обучающий гид** — пошаговый обзор жизненного цикла IT-продукта

## Архитектура

```
                    ┌──────────┐
                    │  Nginx   │ :80
                    └────┬─────┘
              ┌──────────┴──────────┐
              v                     v
     ┌────────────────┐   ┌────────────────┐
     │  React (Vite)  │   │  FastAPI       │ :8000
     │  Tailwind CSS  │   │  SQLAlchemy    │
     │  Framer Motion │   │  Alembic       │
     └────────────────┘   └───┬────────┬───┘
                              v        v
                     ┌──────────┐ ┌─────────┐
                     │ Postgres │ │  Redis   │
                     │    16    │ │    7     │
                     └──────────┘ └─────────┘
                              ^
                     ┌────────┴───────┐
                     │   Scheduler    │
                     │  (APScheduler) │
                     └────────────────┘
```

## Ключевые технические детали

**Пайплайн данных:**
- Scheduler парсит HH.ru каждый час (3 страницы) и ежедневно в 03:00 (20 страниц)
- Каждая вакансия проходит через GPT-4o для фильтрации не-IT ролей
- Нормализация зарплат в KZT для корректной сортировки
- Полнотекстовый поиск PostgreSQL через `tsvector`

**Аутентификация и безопасность:**
- JWT access-токены (15 мин) + refresh-токены (7 дней) с ротацией
- Блокировка аккаунта после неудачных попыток входа
- Подтверждение email и восстановление пароля
- Управление сессиями на нескольких устройствах
- Rate limiting на чувствительных эндпоинтах

**Производительность:**
- Redis-кэширование ответов API (настраиваемый TTL)
- Async/await по всему бэкенду
- Lazy-загрузка роутов на фронтенде
- Health checks на всех Docker-сервисах

## Стек технологий

| Слой | Технологии |
|------|-----------|
| Фронтенд | React 19, Vite, Tailwind CSS, Framer Motion, React Router |
| Бэкенд | FastAPI, SQLAlchemy, Alembic, Pydantic |
| Базы данных | PostgreSQL 16 (полнотекстовый поиск), Redis 7 (кэш + сессии) |
| AI | OpenAI GPT-4o (классификация вакансий, интерпретация теста) |
| Инфра | Docker Compose, Nginx, APScheduler |

## Быстрый старт

```bash
cp .env.example .env    # настройте переменные
docker compose up --build
```

- Фронтенд: `http://localhost`
- API Docs: `http://localhost:8000/docs`
- Health: `http://localhost/healthz`

## Переменные окружения

| Переменная | Обязательна | Описание |
|------------|-------------|----------|
| `DATABASE_URL` | Да | Строка подключения к PostgreSQL |
| `REDIS_URL` | Да | Строка подключения к Redis |
| `JWT_SECRET_KEY` | Да | Секрет для подписи JWT-токенов |
| `INTERNAL_SECRET` | Да | Секрет для админских/внутренних эндпоинтов |
| `OPENAI_API_KEY` | Нет | Включает AI-фильтрацию вакансий и интерпретацию теста |
| `OPENAI_BASE_URL` | Нет | Кастомный эндпоинт OpenAI API (для прокси) |
| `SMTP_HOST` | Нет | SMTP-сервер для верификации и восстановления пароля |

## Обзор API

| Эндпоинт | Описание |
|----------|----------|
| `GET /api/vacancies` | Поиск вакансий с фильтрами, сортировкой, пагинацией |
| `GET /api/companies` | Каталог компаний с количеством активных вакансий |
| `GET /api/recommendations` | Персональные рекомендации на основе профиля |
| `POST /api/interview/start` | Запуск карьерного теста |
| `GET /api/metrics` | Статистика платформы (количество вакансий, зарплаты) |
| `POST /api/auth/register` | Регистрация |
| `POST /api/auth/token` | Авторизация |

Полная документация API доступна по адресу `/docs` (Swagger UI).

## Структура проекта

```
backend/
  app/
    routers/       # API-эндпоинты (auth, vacancies, companies, interview, ...)
    services/      # Бизнес-логика (AI-классификатор, сервис вакансий, email)
    models.py      # SQLAlchemy модели (Vacancy, Company, User, ...)
    database.py    # Подключение к БД и управление сессиями
  scripts/
    hh_scraper.py      # Парсер вакансий с HeadHunter
    ai_clean_db.py     # AI-очистка нерелевантных вакансий
    run_scheduler.py   # Автоматический планировщик задач

frontend/
  src/
    pages/         # 20 страниц
    components/    # 39 переиспользуемых компонентов
    api/           # Модули для работы с API
```
